<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Royal Spice Biriyani House</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:'Poppins',sans-serif;
  background:#fff7e6;
  color:#4a2c2a;
}

/* ================= HEADER ================= */
.main-header{
  background:linear-gradient(135deg,#b33c00,#8f2e00);
  padding:18px 30px;
  box-shadow:0 4px 12px rgba(0,0,0,.25);
}
.brand{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:14px;
}
.logo{font-size:38px}
.brand-text h1{
  margin:0;
  font-size:26px;
  font-weight:600;
  color:#fff;
}
.brand-text p{
  margin:2px 0 0;
  font-size:13px;
  color:#ffd9b3;
}

/* ================= NAV ================= */
nav{
  background:#ffb84d;
  padding:12px;
  text-align:center;
}
nav a{
  margin:0 15px;
  color:#4a2c2a;
  text-decoration:none;
  font-weight:600;
}

/* VERY IMPORTANT ‚Äî add this */
nav a:visited{
  color:#4a2c2a;
}

nav a:active{
  color:#4a2c2a;
}
nav a:hover{color:#fff}

/* ================= HERO ================= */
.hero{
  height:260px;
  background:url('https://images.unsplash.com/photo-1608138273246-3c4d475a726a') center/cover;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:34px;
  color:orange;
  text-shadow:0 0 15px orange;
}
/* SEARCH BAR */
/* SEARCH BAR ‚Äì HIGH VISIBILITY */
.search-box{
  max-width:420px;
  margin:30px auto;
}

.search-box input{
  width:100%;
  padding:14px 20px;
  border-radius:30px;
  border:2px solid #b33c00;
  outline:none;
  font-size:15px;
  background:#ffffff;
  color:#4a2c2a;
  box-shadow:0 6px 16px rgba(0,0,0,.25);
}

.search-box input::placeholder{
  color:#9aa4af;
  font-weight:500;
}




/* ================= MENU ================= */
#menu{
  background:url('https://images.unsplash.com/photo-1543353071-087092ec393a') center/cover;
  padding:40px;
  position:relative;
}
#menu::before{
  content:"";
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.65);
}
#menu>*{position:relative;color:#fff}

.menu-title{
  margin-top:50px;
  font-size:24px;
  font-weight:600;
  color:#ffd9b3;
  border-bottom:2px dashed #ffd9b3;
  padding-bottom:6px;
}

.menu-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:20px;
  margin-top:25px;
}

.menu-item{
  background:#fff3dc;
  color:#4a2c2a;
  padding:18px;
  border-radius:14px;
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  box-shadow:0 8px 20px rgba(0,0,0,.15);
}
.menu-item h3{
  margin:0;
  font-size:18px;
  font-weight:600;
}
.menu-item .desc{
  font-size:13px;
  opacity:.75;
  margin:6px 0 12px;
}
.menu-bottom{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.price{
  background:#b33c00;
  color:white;
  padding:6px 12px;
  border-radius:20px;
  font-weight:600;
  font-size:13px;
}

/* ================= CART ================= */
#cart-section{
  background:#fff0d6;
  padding:40px;
}
#cart{min-height:120px}

.cart-item{
  display:grid;
  grid-template-columns:1fr 120px 80px;
  align-items:center;
  margin:10px 0;
  padding-bottom:8px;
  border-bottom:1px dashed #cc9966;
}
.qty-box{
  display:flex;
  justify-content:center;
  align-items:center;
}
.qty-box button{
  padding:4px 10px;
  margin:0 6px;
}

button{
  background:#cc3300;
  color:#fff;
  border:none;
  padding:8px 14px;
  border-radius:6px;
  cursor:pointer;
}
.order-btn{
  margin-top:20px;
  padding:15px 30px;
  font-size:18px;
}

/* ================= POPUPS ================= */
.popup{
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-60%) scale(.9);
  opacity:0;
  pointer-events:none;
  transition:.35s ease;
  background:#fff;
  padding:30px;
  border-radius:15px;
  width:90%;
  max-width:360px;
  box-shadow:0 0 20px rgba(0,0,0,.5);
  text-align:center;
  z-index:100;
  overflow:hidden;

}
.popup.show{
  opacity:1;
  transform:translate(-50%,-50%) scale(1);
  pointer-events:auto;
}

/* ================= PROGRESS ================= */
.progress-container{margin:20px 0}
.progress-bar{
  height:6px;
  width:0%;
  background:#25a244;
  border-radius:5px;
  transition:width .6s ease;
}
.progress-steps{
  display:flex;
  justify-content:space-between;
  margin-top:8px;
  font-size:13px;
}
.step{opacity:.4}
.step.active{opacity:1;color:#25a244;font-weight:600}
.green-tick{font-size:46px;color:green}

/* ================= CONTACT ================= */
#contact{
  background:#fff7e6;
  padding:40px;
}
.contact-box{
  background:#ffe0b3;
  padding:25px;
  border-radius:10px;
  max-width:600px;
  margin:auto;
}

/* ================= FOOTER ================= */
footer{
  background:#b33c00;
  color:#fff;
  text-align:center;
  padding:20px;
}
/* ================= MOBILE OPTIMISATION ================= */
@media (max-width: 768px){

  /* HEADER */
  .brand{
    flex-direction:column;
    gap:6px;
  }
  .brand-text h1{
    font-size:22px;
    text-align:center;
  }
  .brand-text p{
    text-align:center;
    font-size:12px;
  }

  /* NAV */
  nav a{
    display:inline-block;
    margin:6px 10px;
    font-size:15px;
  }

  /* HERO */
  .hero{
    height:200px;
    font-size:22px;
    padding:15px;
    text-align:center;
  }

  /* SEARCH BAR */
  .search-box{
    max-width:100%;
    padding:0 10px;
  }

  /* CATEGORY FILTERS */
  .category-filters{
    overflow-x:auto;
    white-space:nowrap;
    padding-bottom:10px;
  }
  .filter-btn{
    flex:0 0 auto;
    font-size:13px;
    padding:7px 14px;
  }

  /* MENU GRID */
  .menu-grid{
    grid-template-columns:1fr;
  }

  /* CART */
  .cart-item{
    grid-template-columns:1fr;
    gap:8px;
  }
  .qty-box{
    justify-content:flex-start;
  }

  /* BUTTONS */
  .order-btn{
    width:100%;
    font-size:16px;
  }
  button{
  background:linear-gradient(135deg,#ff6a00,#ff3c00);
  padding:10px 18px;
  border-radius:10px;
  font-weight:600;

  box-shadow:0 6px 14px rgba(255,90,0,.25);
  transition:.2s;
}

button:hover{
  transform:translateY(-2px);
  box-shadow:0 10px 20px rgba(255,90,0,.35);
}


  /* POPUPS */
  .popup{
    max-width:95%;
    padding:20px;
  }
  .popup input,
  .popup textarea{
    width:100%;
    font-size:16px;
  }
}
.category-filters{
  display:flex;
  justify-content:center;
  gap:12px;
  margin:20px 0 30px;
}
/* ===== PREMIUM INPUT STYLE ===== */

input, textarea{
  width:100%;
  padding:14px 18px;

  border-radius:14px;
  border:2px solid transparent;

  background:#f4f6f8;
  font-size:15px;
  color:#333;

  box-shadow:
      0 4px 10px rgba(0,0,0,.05),
      inset 0 1px 2px rgba(0,0,0,.04);

  outline:none;
  transition:all .25s ease;
}

/* FOCUS EFFECT */

input:focus, textarea:focus{

  background:#ffffff;
  border-color:#ff7a00;

  box-shadow:
      0 0 0 4px rgba(255,122,0,.12),
      0 10px 18px rgba(0,0,0,.08);

  transform:translateY(-2px);
}
 /* prevents mobile zoom */

/* ================= DELIVERY POPUP PROFESSIONAL ================= */
.popup-title{
  margin:0;
  font-size:22px;
  font-weight:600;
  color:#b33c00;
}

.popup-sub{
  font-size:13px;
  color:#777;
  margin-bottom:20px;
}

.form-group{
  text-align:left;
  margin-bottom:15px;
}

.form-group label{
  font-size:13px;
  font-weight:500;
  display:block;
  margin-bottom:6px;
  color:#4a2c2a;
}

.dual-input input{
  width:100%;
  padding:14px 16px;
  border-radius:12px;
  border:2px solid transparent;
  font-size:15px;
  outline:none;

  background:#f7f7f7;        /* soft background */
  box-shadow:0 2px 6px rgba(0,0,0,.06);

  transition:all .25s ease;
}


.form-group input:focus,
.dual-input input:focus{

  background:#fff;
  border-color:#ff7a00;

  box-shadow:
      0 0 0 4px rgba(255,122,0,.12),
      0 4px 12px rgba(0,0,0,.08);

  transform:translateY(-1px);
}


.form-group textarea{
  resize:none;
  min-height:80px;
}

.popup-actions{
  display:flex;
  gap:12px;
  margin-top:20px;
}

.primary-btn{
  flex:1;
  background:#cc3300;
  color:#fff;
  padding:12px;
  border-radius:10px;
  font-size:15px;
  font-weight:600;
}

.secondary-btn{
  flex:1;
  background:#eee;
  color:#4a2c2a;
  padding:12px;
  border-radius:10px;
  font-size:15px;
  font-weight:600;
}
/* ===== PRO CARD PAYMENT ===== */

.payment-card{
  max-width:380px;
}

.pay-title{
  margin:0;
  color:#b33c00;
}

.pay-sub{
  font-size:13px;
  color:#777;
  margin-bottom:18px;
}

/* CARD PREVIEW */

.card-preview{
  background:linear-gradient(135deg,#b33c00,#ff7a00);
  color:white;
  border-radius:16px;
  padding:18px;
  margin-bottom:20px;
  box-shadow:0 10px 25px rgba(0,0,0,.25);
}

.chip{
  width:40px;
  height:28px;
  background:gold;
  border-radius:6px;
  margin-bottom:15px;
}

#previewNumber{
  letter-spacing:2px;
  font-size:18px;
  margin-bottom:14px;
}

.card-row{
  display:flex;
  justify-content:space-between;
  font-size:14px;
}

/* INPUT LAYOUT */

/* INPUT LAYOUT ‚Äî FIXED */

.dual-input{
  display:grid;
  grid-template-columns:2fr 1fr;
  gap:12px;
  width:100%;
}

.dual-input div{
  width:100%;
}

.dual-input input{
  width:100%;
  max-width:100%;
}


input{
  transition:.25s;
}

input:focus{
  border-color:#ff7a00;
  box-shadow:0 0 0 3px rgba(255,122,0,.15);
}


</style>
</head>

<body>

<header class="main-header">
  <div class="brand">
    <span class="logo"></span>
    <div class="brand-text">
      <h1>Royal Spice Biriyani House</h1>
      <p>Authentic South Indian, Chinese & Grill</p>
    </div>
  </div>
</header>

<nav>
<a href="#home">Home</a>
<a href="#menu">Menu</a>
<a href="#cart-section">Cart</a>
<a href="#contact">Contact</a>
<a href="login.html">Admin</a>
</a>
</nav>

<div class="hero" id="home">Taste the Authentic South Indian Foods</div>
<!-- SEARCH BAR -->
<div class="search-box">
  <input 
    type="text" 
    id="searchInput" 
    placeholder="Search your favourite food..." 
    onkeyup="searchMenu()"
  >
</div>
<!-- CATEGORY FILTER BUTTONS -->





<section id="menu">
<h2>Menu</h2>

<!-- ================= SOUPS ================= -->
<h3 class="menu-title">Soups</h3>
<div class="menu-grid">
<div class="menu-item"><h3>Tomato Soup</h3><div class="menu-bottom"><span class="price">‚Çπ100</span><button onclick="addToCart('Tomato Soup',100)">Add</button></div></div>
<div class="menu-item"><h3>Sweet Corn Veg Soup</h3><div class="menu-bottom"><span class="price">‚Çπ100</span><button onclick="addToCart('Sweet Corn Veg Soup',100)">Add</button></div></div>
<div class="menu-item"><h3>Hot & Sour Veg Soup</h3><div class="menu-bottom"><span class="price">‚Çπ100</span><button onclick="addToCart('Hot & Sour Veg Soup',100)">Add</button></div></div>
<div class="menu-item"><h3>Veg Mushroom Soup</h3><div class="menu-bottom"><span class="price">‚Çπ100</span><button onclick="addToCart('Veg Mushroom Soup',100)">Add</button></div></div>

<div class="menu-item"><h3>Sweet Corn Chicken Soup</h3><div class="menu-bottom"><span class="price">‚Çπ115</span><button onclick="addToCart('Sweet Corn Chicken Soup',115)">Add</button></div></div>
<div class="menu-item"><h3>Chicken Clear Soup</h3><div class="menu-bottom"><span class="price">‚Çπ115</span><button onclick="addToCart('Chicken Clear Soup',115)">Add</button></div></div>
<div class="menu-item"><h3>Hot & Sour Chicken Soup</h3><div class="menu-bottom"><span class="price">‚Çπ115</span><button onclick="addToCart('Hot & Sour Chicken Soup',115)">Add</button></div></div>
<div class="menu-item"><h3>Mutton Bone Soup</h3><div class="menu-bottom"><span class="price">‚Çπ130</span><button onclick="addToCart('Mutton Bone Soup',130)">Add</button></div></div>
</div>

<!-- ================= STARTERS VEG ================= -->
<h3 class="menu-title">Starters (Veg)</h3>
<div class="menu-grid">
<div class="menu-item"><h3>Gobi 65</h3><div class="menu-bottom"><span class="price">‚Çπ160</span><button onclick="addToCart('Gobi 65',160)">Add</button></div></div>
<div class="menu-item"><h3>Gobi Manchurian</h3><div class="menu-bottom"><span class="price">‚Çπ180</span><button onclick="addToCart('Gobi Manchurian',180)">Add</button></div></div>
<div class="menu-item"><h3>Chilly Gobi</h3><div class="menu-bottom"><span class="price">‚Çπ180</span><button onclick="addToCart('Chilly Gobi',180)">Add</button></div></div>
<div class="menu-item"><h3>Mushroom 65</h3><div class="menu-bottom"><span class="price">‚Çπ190</span><button onclick="addToCart('Mushroom 65',190)">Add</button></div></div>
<div class="menu-item"><h3>Paneer 65</h3><div class="menu-bottom"><span class="price">‚Çπ190</span><button onclick="addToCart('Paneer 65',190)">Add</button></div></div>
<div class="menu-item"><h3>Paneer Tikka</h3><div class="menu-bottom"><span class="price">‚Çπ230</span><button onclick="addToCart('Paneer Tikka',230)">Add</button></div></div>
</div>

<!-- ================= STARTERS NON VEG ================= -->
<h3 class="menu-title">Starters (Non Veg)</h3>
<div class="menu-grid">
<div class="menu-item"><h3>Chicken 65</h3><div class="menu-bottom"><span class="price">‚Çπ170</span><button onclick="addToCart('Chicken 65',170)">Add</button></div></div>
<div class="menu-item"><h3>Chicken Lollipop (5 pcs)</h3><div class="menu-bottom"><span class="price">‚Çπ200</span><button onclick="addToCart('Chicken Lollipop',200)">Add</button></div></div>
<div class="menu-item"><h3>Chicken Drumstick</h3><div class="menu-bottom"><span class="price">‚Çπ220</span><button onclick="addToCart('Chicken Drumstick',220)">Add</button></div></div>
<div class="menu-item"><h3>Fish Fry (Seasonal)</h3><div class="menu-bottom"><span class="price">‚Çπ240</span><button onclick="addToCart('Fish Fry',240)">Add</button></div></div>
<div class="menu-item"><h3>Mutton Kola</h3><div class="menu-bottom"><span class="price">‚Çπ240</span><button onclick="addToCart('Mutton Kola',240)">Add</button></div></div>
</div>

<!-- ================= BIRIYANI ================= -->
<h3 class="menu-title">Biriyani</h3>
<div class="menu-grid">
<div class="menu-item"><h3>Chicken Biriyani</h3><div class="menu-bottom"><span class="price">‚Çπ190</span><button onclick="addToCart('Chicken Biriyani',190)">Add</button></div></div>
<div class="menu-item"><h3>Mutton Biriyani</h3><div class="menu-bottom"><span class="price">‚Çπ300</span><button onclick="addToCart('Mutton Biriyani',300)">Add</button></div></div>
<div class="menu-item"><h3>Egg Biriyani</h3><div class="menu-bottom"><span class="price">‚Çπ200</span><button onclick="addToCart('Egg Biriyani',200)">Add</button></div></div>
<div class="menu-item"><h3>Fish Biriyani</h3><div class="menu-bottom"><span class="price">‚Çπ300</span><button onclick="addToCart('Fish Biriyani',300)">Add</button></div></div>
<div class="menu-item"><h3>Plain Biriyani</h3><div class="menu-bottom"><span class="price">‚Çπ190</span><button onclick="addToCart('Plain Biriyani',190)">Add</button></div></div>
</div>

<!-- ================= FRIED RICE ================= -->
<h3 class="menu-title">Fried Rice</h3>
<div class="menu-grid">
<div class="menu-item"><h3>Veg Fried Rice</h3><div class="menu-bottom"><span class="price">‚Çπ120</span><button onclick="addToCart('Veg Fried Rice',120)">Add</button></div></div>
<div class="menu-item"><h3>Egg Fried Rice</h3><div class="menu-bottom"><span class="price">‚Çπ150</span><button onclick="addToCart('Egg Fried Rice',150)">Add</button></div></div>
<div class="menu-item"><h3>Chicken Fried Rice</h3><div class="menu-bottom"><span class="price">‚Çπ180</span><button onclick="addToCart('Chicken Fried Rice',180)">Add</button></div></div>
<div class="menu-item"><h3>Prawn Fried Rice</h3><div class="menu-bottom"><span class="price">‚Çπ200</span><button onclick="addToCart('Prawn Fried Rice',200)">Add</button></div></div>
</div>

<!-- ================= NOODLES ================= -->
<h3 class="menu-title">Noodles</h3>
<div class="menu-grid">
<div class="menu-item"><h3>Veg Noodles</h3><div class="menu-bottom"><span class="price">‚Çπ120</span><button onclick="addToCart('Veg Noodles',120)">Add</button></div></div>
<div class="menu-item"><h3>Egg Noodles</h3><div class="menu-bottom"><span class="price">‚Çπ150</span><button onclick="addToCart('Egg Noodles',150)">Add</button></div></div>
<div class="menu-item"><h3>Chicken Noodles</h3><div class="menu-bottom"><span class="price">‚Çπ180</span><button onclick="addToCart('Chicken Noodles',180)">Add</button></div></div>
<div class="menu-item"><h3>Prawn Noodles</h3><div class="menu-bottom"><span class="price">‚Çπ200</span><button onclick="addToCart('Prawn Noodles',200)">Add</button></div></div>
</div>

<!-- ================= SHAWARMA ================= -->
<h3 class="menu-title">Shawarma</h3>
<div class="menu-grid">
<div class="menu-item"><h3>Shawarma Roll</h3><div class="menu-bottom"><span class="price">‚Çπ110</span><button onclick="addToCart('Shawarma Roll',110)">Add</button></div></div>
<div class="menu-item"><h3>Shawarma Plate</h3><div class="menu-bottom"><span class="price">‚Çπ200</span><button onclick="addToCart('Shawarma Plate',200)">Add</button></div></div>
<div class="menu-item"><h3>Paratha Shawarma</h3><div class="menu-bottom"><span class="price">‚Çπ125</span><button onclick="addToCart('Paratha Shawarma',125)">Add</button></div></div>
<div class="menu-item"><h3>Spl Chicken Shawarma</h3><div class="menu-bottom"><span class="price">‚Çπ130</span><button onclick="addToCart('Spl Chicken Shawarma',130)">Add</button></div></div>
</div>

</section>

<section id="cart-section">
<h2>üõí Your Cart</h2>
<div id="cart"><p>Your cart is empty</p></div>
<h3>Total ‚Çπ<span id="total">0</span></h3>
<button class="order-btn" onclick="showPaymentPopup()">Pay & Place Order</button>
</section>

<section id="contact">
  <h2>üìû Contact Us</h2>

  <div class="contact-box">
    <p><strong>Royal Spice Biriyani House</strong></p>

    <p>
      No. 45/2,<br>
      Main Road,<br>
      Near Gandhi Market Bus Stop,<br>
      Woraiyur,<br>
      Tiruchirappalli ‚Äì 620003,<br>
      Tamil Nadu, India.
    </p>

    <p><strong>üì± Phone:</strong> +91 98765 43210</p>
    <p><strong>‚òéÔ∏è Alternate:</strong> +91 97890 12345</p>

    <p><strong>üìß Email:</strong> royalspicebiriyani@gmail.com</p>

    <p><strong>üïí Working Hours:</strong><br>
      Monday ‚Äì Sunday : 10:00 AM ‚Äì 10:30 PM
    </p>

    <p><strong>üöö Home Delivery:</strong> Available within Trichy city limits</p>
  </div>
</section>


<footer>¬© 2025 Royal Spice Biriyani House</footer>

<div class="popup" id="payment">
  <h3>Select Payment Method</h3>
  <p>Total ‚Çπ<span id="payTotal">0</span></p>

  <button onclick="openCardPopup()">üí≥ Card Payment</button><br><br>
  <button onclick="openUPIPopup()">üì± UPI Payment</button><br><br>
  <button onclick="openCODPopup()">üíµ Cash on Delivery</button><br><br>

  <button onclick="resetEntireOrder(); closeAll()">Cancel</button>


</div>
<div class="popup payment-card" id="cardPopup">

  <h2 class="pay-title">üí≥ Secure Card Payment</h2>
  <p class="pay-sub">All transactions are encrypted</p>

  <div class="card-preview">
      <div class="chip"></div>
      <div id="previewNumber">‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div>
      <div class="card-row">
          <span id="previewName">YOUR NAME</span>
          <span id="previewExpiry">MM/YY</span>
      </div>
  </div>

  <div class="form-group">
      <label>Card Number</label>
      <input 
        type="text" 
        id="cardNumber"
        maxlength="16"
        placeholder="1234 5678 9012 3456"
        oninput="updateCardPreview()">
  </div>

  <div class="dual-input">
      <div>
        <label>Expiry</label>
        <input 
          type="text" 
          id="expiry"
          maxlength="5"
          placeholder="MM/YY"
          oninput="updateCardPreview()">
      </div>

      <div>
        <label>CVV</label>
        <input 
          type="password" 
          id="cvv"
          maxlength="3"
          placeholder="‚Ä¢‚Ä¢‚Ä¢">
      </div>
  </div>

  <div class="popup-actions">
      <button class="primary-btn" onclick="confirmCardPayment()">Pay Securely</button>
      <button class="secondary-btn" onclick="backToPayment()">Cancel</button>
  </div>

</div>

<div class="popup" id="upiPopup">
  <h3>UPI Payment</h3>
  <input type="text" id="upiId" placeholder="example@upi"><br><br>
  <button onclick="generateUPIQR()">Generate QR</button>

  <div id="upiQRBox" style="display:none;margin-top:15px;">
    <img id="upiQR" width="200"><br><br>
    <button onclick="confirmUPIPayment()">Payment Done</button>
  </div>

  <button onclick="backToPayment()">Back</button>
</div>
<div class="popup" id="codPopup">
  <h3 class="popup-title">üöö Delivery Details</h3>
  <p class="popup-sub">Please enter your delivery information</p>

  <div class="form-group">
    <label>Full Name</label>
    <input type="text" id="custName" placeholder="Enter your name">
  </div>

  <div class="form-group">
    <label>Mobile Number</label>
    <input type="text" id="custPhone" placeholder="Enter phone number">
  </div>

  <div class="form-group">
    <label>Delivery Address</label>
    <textarea id="custAddress" placeholder="House no, street, area, city"></textarea>
  </div>

  <div class="popup-actions">
    <button class="primary-btn" onclick="confirmCOD()">Place Order</button>
    <button class="secondary-btn" onclick="backToPayment()">Back</button>
  </div>
</div>

<!-- ORDER CONFIRM -->
<div class="popup" id="order">
  <div class="green-tick">‚úîÔ∏è</div>
  <h3>Order Placed!</h3>
  <div id="orderItems"></div>

  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
    <div class="progress-steps">
      <span class="step active">Placed</span>
      <span class="step">Preparing</span>
      <span class="step">Ready</span>
      <span class="step">Delivered</span>
    </div>
  </div>
  <button onclick="downloadInvoice()">üßæ Download Invoice</button>
<br><br>
  <button onclick="closeAll()">OK</button>
</div>


<script>
let cart={}, lastOrder={};

function addToCart(item,price){
  cart[item]?cart[item].qty++:cart[item]={price,qty:1};
  updateCart();
}

function changeQty(item,val){
  cart[item].qty+=val;
  if(cart[item].qty<=0) delete cart[item];
  updateCart();
}

function updateCart(){
  const cartDiv=document.getElementById("cart");
  cartDiv.innerHTML="";
  let total=0;

  if(Object.keys(cart).length===0){
    cartDiv.innerHTML="<p>Your cart is empty</p>";
    document.getElementById("total").innerText=0;
    return;
  }

  Object.entries(cart).forEach(([item,data])=>{
    total+=data.price*data.qty;
    cartDiv.innerHTML+=`
      <div class="cart-item">
        <span>${item}</span>
        <div class="qty-box">
          <button onclick="changeQty('${item}',-1)">‚àí</button>
          ${data.qty}
          <button onclick="changeQty('${item}',1)">+</button>
        </div>
        <span>‚Çπ${data.price*data.qty}</span>
      </div>`;
  });

  document.getElementById("total").innerText=total;
}

function searchMenu(){
  let input = document.getElementById("searchInput").value.toLowerCase();
  let items = document.querySelectorAll(".menu-item");

  items.forEach(item => {
    let text = item.innerText.toLowerCase();
    item.style.display = text.includes(input) ? "flex" : "none";
  });
}
function showPaymentPopup(){
  if(Object.keys(cart).length === 0){
    alert("Cart is empty!");
    return;
  }
  document.getElementById("payTotal").innerText =
    document.getElementById("total").innerText;
  document.getElementById("payment").classList.add("show");
}

/* PAYMENT MODES */
let currentOrderId="";

/* OPEN POPUPS */
function openCardPopup(){
  closeAll();
  document.getElementById("cardPopup").classList.add("show");
}
function openUPIPopup(){
  closeAll();
  document.getElementById("upiPopup").classList.add("show");
}
function openCODPopup(){
  closeAll();
  document.getElementById("codPopup").classList.add("show");
}

/* BACK */
function backToPayment(){
   clearPaymentForms();
  closeAll();
  document.getElementById("payment").classList.add("show");
}

/* CARD */
function confirmCardPayment(){
  let card=document.getElementById("cardNumber").value;
  let cvv=document.getElementById("cvv").value;
  if(card.length!==16 || cvv.length!==3){
    alert("Invalid card details");
    return;
  }
  placeOrder();
}

/* UPI */
function generateUPIQR(){
  let upi=document.getElementById("upiId").value;
  if(!upi.includes("@")){
    alert("Invalid UPI ID");
    return;
  }
  let amount=document.getElementById("total").innerText;
  let url=`upi://pay?pa=${upi}&pn=Royal Spice Biriyani House&am=${amount}&cu=INR`;
  document.getElementById("upiQR").src =
    "https://api.qrserver.com/v1/create-qr-code/?size=200x200&data="+
    encodeURIComponent(url);
  document.getElementById("upiQRBox").style.display="block";
}
function confirmUPIPayment(){
  placeOrder();
}

/* COD */
function confirmCOD(){
  let phone=document.getElementById("custPhone").value;
  let addr=document.getElementById("custAddress").value;
  if(phone.length<10 || addr===""){
    alert("Enter valid details");
    return;
  }
  placeOrder();
}

/* ORDER */
function placeOrder(){
  closeAll();

  currentOrderId = "RSB" + Math.floor(100000 + Math.random() * 900000);

  // ‚úÖ STORE ORDER BEFORE CLEARING
  lastOrder = JSON.parse(JSON.stringify(cart));
  // ‚≠ê SAVE ORDER TO FIREBASE
saveOrderToFirebase();



  let items = document.getElementById("orderItems");
  items.innerHTML = `<p><strong>Order ID:</strong> ${currentOrderId}</p>`;

  let total = 0;

  for(let item in lastOrder){
    items.innerHTML += `<p>${item} √ó ${lastOrder[item].qty}</p>`;
    total += lastOrder[item].price * lastOrder[item].qty;
  }

  items.innerHTML += `<p><strong>Total: ‚Çπ${total}</strong></p>`;

  document.getElementById("order").classList.add("show");
  startOrderTracking();


  // ‚úÖ CLEAR CART AFTER COPYING
  cart = {};
  updateCart();
}


/* CLOSE */
function closeAll(){
  document.querySelectorAll(".popup").forEach(p=>p.classList.remove("show"));
}

function downloadInvoice(){
  
  const { jsPDF } = window.jspdf;
  let doc = new jsPDF();

  let y = 20;
  let total = 0;

  // ‚≠ê HEADER
  doc.setFont("helvetica","bold");
  doc.setFontSize(20);
  doc.text("Royal Spice Biriyani House", 105, y, null, null, "center");

  y+=8;

  doc.setFontSize(10);
  doc.setFont("helvetica","normal");
  doc.text("Trichy | Ph: +91 98765 43210",105,y,null,null,"center");

  y+=10;

  // divider
  doc.line(20,y,190,y);

  y+=10;

  // ‚≠ê ORDER INFO
  doc.setFontSize(12);
  doc.text(`Order ID: ${currentOrderId}`,20,y);

  let date = new Date().toLocaleString();
  doc.text(`Date: ${date}`,140,y);

  y+=10;

  // divider
  doc.line(20,y,190,y);

  y+=8;

  // ‚≠ê TABLE HEADER
  doc.setFont("helvetica","bold");

  doc.text("Item",20,y);
  doc.text("Qty",120,y);
  doc.text("Price",160,y);

  y+=4;
  doc.line(20,y,190,y);

  y+=8;

  doc.setFont("helvetica","normal");

  // ‚≠ê ITEMS
  for(let item in lastOrder){

    let qty = lastOrder[item].qty;
    let price = lastOrder[item].price * qty;

    total += price;

    doc.text(item,20,y);
    doc.text(String(qty),125,y);
    doc.text("‚Çπ"+price,160,y);

    y+=8;
  }

  y+=5;
  doc.line(20,y,190,y);

  y+=10;

  // ‚≠ê TOTAL
  doc.setFont("helvetica","bold");
  doc.setFontSize(14);

  doc.text(`Total: ‚Çπ${total}`,150,y);

  y+=15;

  // ‚≠ê FOOTER
  doc.setFontSize(11);
  doc.setFont("helvetica","normal");

  doc.text("Thank you for dining with us!",105,y,null,null,"center");
  y+=6;
  doc.text("Visit Again ",105,y,null,null,"center");

  doc.save(`Invoice_${currentOrderId}.pdf`);
}




function confirmUPIPayment(){
  placeOrder();
}
function updateCardPreview(){

  let number = document.getElementById("cardNumber").value;
  let expiry = document.getElementById("expiry").value;

  // format card number
  number = number.replace(/\D/g,'')
                 .replace(/(.{4})/g,'$1 ')
                 .trim();

  document.getElementById("previewNumber").innerText =
      number || "‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢";

  document.getElementById("previewExpiry").innerText =
      expiry || "MM/YY";
}
function startOrderTracking(){

  const steps = document.querySelectorAll(".step");
  const bar = document.getElementById("progressBar");

  // reset first
  steps.forEach(step => step.classList.remove("active"));
  steps[0].classList.add("active");
  bar.style.width = "25%";

  setTimeout(()=>{
    steps[1].classList.add("active");
    bar.style.width = "50%";
  },3000); // 3 seconds

  setTimeout(()=>{
    steps[2].classList.add("active");
    bar.style.width = "75%";
  },6000); // 6 seconds

  setTimeout(()=>{
    steps[3].classList.add("active");
    bar.style.width = "100%";
  },9000); // 9 seconds
}
function clearPaymentForms(){

  // CARD
  document.getElementById("cardNumber").value="";
  document.getElementById("expiry").value="";
  document.getElementById("cvv").value="";

  // reset card preview
  document.getElementById("previewNumber").innerText="‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢";
  document.getElementById("previewExpiry").innerText="MM/YY";

  // UPI
  document.getElementById("upiId").value="";
  document.getElementById("upiQRBox").style.display="none";

  // COD
  document.getElementById("custName").value="";
  document.getElementById("custPhone").value="";
  document.getElementById("custAddress").value="";
}
function resetEntireOrder(){

  // ‚úÖ clear cart
  cart = {};
  updateCart();

  // ‚úÖ clear saved order
  lastOrder = {};

  // ‚úÖ clear payment inputs
  clearPaymentForms();
}
async function saveOrderToFirebase(){

  if(!window.db){
    console.log("DB not ready");
    return;
  }

  let total = document.getElementById("total").innerText;

  try{
    await addDoc(collection(window.db,"orders"),{
      orderId: currentOrderId,
      items: lastOrder,
      total: total,
      status: "Placed",
      created: new Date().toLocaleString()
    });

    console.log("Order saved to Firebase ‚úÖ");

  }catch(e){
    console.error("Firebase error", e);
  }
}

</script>
<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";

import { 
  getFirestore, 
  collection, 
  addDoc 
} from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCPWXEztAyRqOQaFRIJVZJtBU2TINCE_4A",
  authDomain: "biriyani-app-7f501.firebaseapp.com",
  projectId: "biriyani-app-7f501",
  storageBucket: "biriyani-app-7f501.firebasestorage.app",
  messagingSenderId: "661067427617",
  appId: "1:661067427617:web:c85182f904010348199860",
  measurementId: "G-X69V1VFJFJ"
};

// ‚úÖ Initialize Firebase
const app = initializeApp(firebaseConfig);

// ‚úÖ CREATE DATABASE INSTANCE
const db = getFirestore(app);

// ‚≠ê GLOBAL ACCESS
window.db = db;
window.collection = collection;
window.addDoc = addDoc;

</script>

</body>
</html>
